{% extends "main/base.html" %}
{% load static %}  {# <-- Add this line to use {% static %} #}

{% block title %}Doctor Profile{% endblock %}

{% block content %}
<section class="doctor-profile container">
    <h2>{{ doctor.name }}</h2>

    <!-- Doctor Image -->
    {% if doctor.image %}
        <img src="{{ doctor.image.url }}" alt="{{ doctor.name }}" style="width:200px; height:250px; object-fit:cover; border-radius:8px; margin-bottom:1rem;">
    {% else %}
        <img src="{% static 'main/images/doctor_profile.png' %}" alt="{{ doctor.name }}" style="width:200px; height:250px; object-fit:cover; border-radius:8px; margin-bottom:1rem;">
    {% endif %}

    <!-- Doctor Info -->
    <p><strong>Specialty:</strong> {{ doctor.specialty|default:"Not specified" }}</p>
    <p><strong>Languages:</strong>
        {% if doctor.language_list %}
            {{ doctor.language_list|join:", " }}
        {% else %}
            Not specified
        {% endif %}
    </p>
    <p><strong>Location:</strong> {{ doctor.location|default:"Not available" }}</p>
    <p><strong>Consultation Fee:</strong> ৳{{ doctor.fee|default:"N/A" }}</p>
    <p class="bio"><strong>Bio:</strong> {{ doctor.bio|default:"No biography available." }}</p>

    <!-- Schedule -->
    <h3>Available Schedules</h3>
    {% if schedules %}
    <ul>
        {% for s in schedules %}
            <li>{{ s.day }}: {{ s.start_time|time:"h:i A" }} – {{ s.end_time|time:"h:i A" }}</li>
        {% endfor %}
    </ul>
    {% else %}
    <p>No schedule available.</p>
    {% endif %}

    <!-- Appointment Booking (only for non-doctor users) -->
    {% if is_doctor is not True %}
        <div class="book-widget" style="margin-top:2rem;">
            <h4>Book an Appointment</h4>
            <form method="POST" action="{% url 'book_appointment' doctor.id %}" class="appointment-form" style="display:flex; flex-direction:column; gap:0.8rem; max-width:400px;">
                {% csrf_token %}

                <label for="visitType">Visit Type</label>
                <select id="visitType" name="visitType" required style="padding:0.4rem; border:1px solid #ccc; border-radius:4px;">
                    <option value="" disabled selected>Select type</option>
                    <option value="online">Online</option>
                </select>

                <label for="date">Date</label>
                <input type="date" id="date" name="date" required min="{{ today|date:'Y-m-d' }}" style="padding:0.4rem; border:1px solid #ccc; border-radius:4px;">

                <label for="time">Time</label>
                <input type="time" id="time" name="time" required style="padding:0.4rem; border:1px solid #ccc; border-radius:4px;">

                <label for="notes">Notes (optional)</label>
                <textarea id="notes" name="notes" rows="3" placeholder="Any additional details..." style="padding:0.4rem; border:1px solid #ccc; border-radius:4px;"></textarea>

                <button type="submit" class="btn primary-btn" style="margin-top:1rem;">Confirm Appointment</button>
            </form>
        </div>
    {% endif %}
</section>
{% endblock %}
